#ifndef _1602_H_
#define _1602_H_
#include <msp430x14x.h>
//*************************************************************************
//			åˆå§‹åŒ–IOå£å­ç¨‹åº
//*************************************************************************
void Port_Init()
{

	P4SEL = 0x00;
        P4DIR = 0xFF;                   //æ•°æ®å£è¾“å‡ºæ¨¡å¼?        P5SEL = 0x00;
        P5DIR|= BIT5 + BIT6 + BIT7;     //æ§åˆ¶å£è®¾ç½®ä¸ºè¾“å‡ºæ¨¡å¼
}

//***********************************************************************
//	æ˜¾ç¤ºå±å‘½ä»¤å†™å…¥å‡½æ•?//***********************************************************************
void LCD_write_com(unsigned char com) 
{	
	RS_CLR;
	RW_CLR;
	EN_SET;
	DataPort = com;                 //å‘½ä»¤å†™å…¥ç«¯å£
	delay_ms(5);
	EN_CLR;
}

//***********************************************************************
//	æ˜¾ç¤ºå±æ•°æ®å†™å…¥å‡½æ•?//***********************************************************************
void LCD_write_data(unsigned char data) 
{
	RS_SET;
	RW_CLR;
	EN_SET;
	DataPort = data;                //æ•°æ®å†™å…¥ç«¯å£
	delay_ms(5);
	EN_CLR;
}

//***********************************************************************
//	æ˜¾ç¤ºå±æ¸…ç©ºæ˜¾ç¤?//***********************************************************************
void LCD_clear(void) 
{
	LCD_write_com(0x01);            //æ¸…å±å¹•æ˜¾ç¤?	delay_ms(5);
}

//***********************************************************************
//	æ˜¾ç¤ºå±å­—ç¬¦ä¸²å†™å…¥å‡½æ•°
//***********************************************************************
void LCD_write_str(unsigned char x,unsigned char y,unsigned char *s) 
{
	
    if (y == 0) 
    {
    	LCD_write_com(0x80 + x);        //ç¬¬ä¸€è¡Œæ˜¾ç¤?    }
    else 
    {
    	LCD_write_com(0xC0 + x);        //ç¬¬äºŒè¡Œæ˜¾ç¤?    }
    
    while (*s) 
    {
    	LCD_write_data( *s);
    	s ++;
    }
}

//***********************************************************************
//	æ˜¾ç¤ºå±å•å­—ç¬¦å†™å…¥å‡½æ•°
//***********************************************************************
void LCD_write_char(unsigned char x,unsigned char y,unsigned char data) 
{
	
    if (y == 0) 
    {
    	LCD_write_com(0x80 + x);        //ç¬¬ä¸€è¡Œæ˜¾ç¤?    }
    else 
    {
    	LCD_write_com(0xC0 + x);        //ç¬¬äºŒè¡Œæ˜¾ç¤?    }
    
    LCD_write_data( data);  
}
//æ˜¾ç¤ºä¸€ä¸ªä¸å¤§äºäº”ä½æ•°çš„æ•°å­—
void LCD1602_write_number(unsigned char x,unsigned char y,unsigned int data)
{
  uchar i;
  uint divide=10000;
  data= data%100000;
  for(i=0;i<5;i++)
  {
    LCD1602_write_char( x++, y, 0x30+data/divide);
    data=data%divide;
    divide /=10;
  }
 
}
//***********************************************************************
//	æ˜¾ç¤ºå±åˆå§‹åŒ–å‡½æ•°
//***********************************************************************
void LCD_init(void) 
{
    LCD_write_com(0x38);		//æ˜¾ç¤ºæ¨¡å¼è®¾ç½®  
    delay_ms(5);
    LCD_write_com(0x08);		//æ˜¾ç¤ºå…³é—­
    delay_ms(5);
    LCD_write_com(0x01);		//æ˜¾ç¤ºæ¸…å±
    delay_ms(5);
    LCD_write_com(0x06);		//æ˜¾ç¤ºå…‰æ ‡ç§»åŠ¨è®¾ç½®
    delay_ms(5);
    LCD_write_com(0x0C);		//æ˜¾ç¤ºå¼€åŠå…‰æ ‡è®¾ç½?    delay_ms(5);
}

//***********************************************************************
//      æ¶²æ™¶æ˜¾ç¤ºç•Œé¢åˆå§‹åŒ?//***********************************************************************
void LCD_Desk(void)
{    
  LCD_clear();
  LCD_write_str(0,0,"ADC0 Input:");
  LCD_write_str(0,1,"Voltage   :");
  delay_ms(250);
}
#endif
